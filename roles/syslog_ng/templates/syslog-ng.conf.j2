@version: 3.25
@include "scl.conf"

options {
    chain_hostnames(off);
    flush_lines(0);
    use_dns(no);
    use_fqdn(no);
    dns_cache(no);
    owner("root");
    group("adm");
    perm(0640);
    stats_freq(0);
    bad_hostname("^gconfd$");
};

source s_local {
    system();
    internal();
};

destination d_audit {
    file("/var/log/audit/splunk_audit.log" create_dirs(yes) perm(0640));
};

destination d_syslog {
    file("/var/log/syslog-ng/all_logs.log" create_dirs(yes) perm(0640));
};

destination d_auth {
    file("/var/log/auth.log" perm(0640));
};

filter f_audit {
    program("auditd") or match("type=SYSCALL" value("MESSAGE")) or match("type=CONFIG_CHANGE" value("MESSAGE")) or match("etc_monitor" value("MESSAGE"));
};

filter f_auth {
    facility(auth, authpriv) and not match("etc_monitor" value("MESSAGE"));
};

log {
    source(s_local);
    filter(f_audit);
    destination(d_audit);
};

log {
    source(s_local);
    destination(d_syslog);
};

log {
    source(s_local);
    filter(f_auth);
    destination(d_auth);
};

@include "/etc/syslog-ng/conf.d/*.conf"

